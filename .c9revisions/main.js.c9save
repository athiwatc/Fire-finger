{"ts":1352799034991,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"\r\n/* Stage */\r\nvar canvas; // Canvas reference\r\nvar stage; // Stage reference\r\n\r\n/* Text Field */\r\nvar gameText; // Game TextField\r\nvar descriptionText; // Game description TextField\r\nvar singlePlayText; // Single player TextField\r\nvar multiPlayText; // Multi player TextFiled\r\nvar creditText; // Credit TextField\r\nvar scoreText; // Score TextField\r\nvar hpText; // HP TextField\r\nvar overText; // Game Over TextField\r\nvar developerText; // Developer TextField\r\nvar playerText; // Player input TextField\r\n\r\nString.prototype.trim=function(){return this.replace(/^\\s\\s*/, '').replace(/\\s\\s*$/, '');}\r\n\r\n/* Word list */\r\nvar wordList;\r\n\r\n/* Container */\r\nvar wordContainer; // Word container\r\n\r\n/* Image */\r\nvar bg; // Background\r\nvar bgSrc; // Background source\r\n\r\n/* Playing state */\r\nvar isStart;\r\nvar isOver;\r\n\r\n/* Current word */\r\nvar current_word;\r\n\r\n/* Click state*/\r\nvar click;\r\n\r\n/* Player status */\r\nvar score;\r\nvar hp;\r\n\r\n// Combo\r\nvar combo = 0;\r\n\r\n/* Frame Counter */\r\nvar create_counter; // Frame counter for generate word\r\nvar check_counter; // Frame counter for check word correctness\r\n\r\n/* Constant */\r\nvar ONE_SECOND = 30;\r\n\r\n// Initial function\r\nfunction init() {\r\n\r\n    canvas = document.getElementById(\"canvas\"); // Reference to canvas\r\n    stage = new createjs.Stage(canvas); // Create stage\r\n\r\n    // Mouse event\r\n    canvas.onmouseup = onMouseUp;\r\n    canvas.onmousedown = onMouseDown;\r\n\r\n    // Keyboard event\r\n    document.onkeypress = onTyping;\r\n\r\n    stage.mouseEventsEnabled = true; // Enabled mouse event\r\n\r\n    // Load background image\r\n    bgSrc = new Image();\r\n    bgSrc.src = \"img/bg.png\";\r\n    bgSrc.onload = loadBackground;\r\n\r\n    /* Initial Variable */\r\n    hp = 100;\r\n    score = 0;\r\n    create_counter = 0;\r\n    check_counter = 0;\r\n    current_word = -1;\r\n\r\n    /* Initial State */\r\n    isStart = false;\r\n    isOver = false;\r\n    click = false;\r\n\r\n    // Create TextField\r\n    createText();\r\n\r\n    // Create word container\r\n    wordContainer = new createjs.Container();\r\n\r\n    // Init word list\r\n    wordList = new Array();\r\n\r\n    // Init frame rate and timer\r\n    createjs.Ticker.setFPS(60);\r\n    createjs.Ticker.addListener(window);\r\n\r\n}\r\n\r\n// Mouse up event\r\nfunction onMouseUp(e) {\r\n    click = false;\r\n}\r\n\r\n// Mouse down event\r\nfunction onMouseDown(e) {\r\n    click = true;\r\n}\r\n\r\n// Typing event\r\nfunction onTyping(e) {\r\n    // If user type alphabet appent to  playerText\r\n    if (isAlphabet(String.fromCharCode(e.charCode))) {\r\n\r\n        // If first character, make it to uppercase\r\n        if (playerText.text.length == 0) {\r\n            playerText.text += String.fromCharCode(e.charCode).toUpperCase();\r\n        } else {\r\n            playerText.text += String.fromCharCode(e.charCode);\r\n        }\r\n    }\r\n}\r\n\r\nfunction isAlphabet(c) {\r\n    return /^[a-zA-Z()]$/.test(c);\r\n}\r\n\r\nfunction startWith(str, pattern) {\r\n    return pattern == str.substr(0, pattern.length);\r\n}\r\n\r\n// Create TextField\r\nfunction createText() {\r\n\r\n    // Create All TextField\r\n    gameText = new createjs.Text(\"Fire Finger\", \"36px Segoe UI Bold Italic\", \"#fff\");\r\n    descriptionText = new createjs.Text(\"Type to play!!!\", \"14px Segoe UI Italic\", \"#fff\");\r\n    singlePlayText = new createjs.Text(\"Single Player\", \"18px Segoe UI Italic\", \"#fff\");\r\n    multiPlayText = new createjs.Text(\"Multi Player\", \"18px Segoe UI Italic\", \"#fff\");\r\n    creditText = new createjs.Text(\"Credit\", \"18px Segoe UI Italic\", \"#fff\");\r\n    scoreText = new createjs.Text(\"Score : \" + score, \"16px Segoe UI Italic\", \"#fff\");\r\n    hpText = new createjs.Text(\"HP : \" + hp, \"16px Segoe UI Italic\", \"#fff\");\r\n    overText = new createjs.Text(\"Game Over\", \"30px Segoe UI Italic\", \"#fff\");\r\n    developerText = new createjs.Text(\"Develop by Spark Studio\", \"14px Segoe UI Italic\", \"#fff\")\r\n    playerText = new createjs.Text(\"\", \"18px Segoe UI Italic\", \"#fff\");\r\n\r\n    /*Set TextField Position*/\r\n    gameText.textAlign = \"center\";\r\n    gameText.x = canvas.width / 2;\r\n    gameText.y = 150;\r\n    descriptionText.textAlign = \"center\";\r\n    descriptionText.x = canvas.width / 2;\r\n    descriptionText.y = 210;\r\n    singlePlayText.textAlign = \"center\";\r\n    singlePlayText.x = canvas.width / 2;\r\n    singlePlayText.y = 270;\r\n    singlePlayText.name = \"single\";\r\n    multiPlayText.textAlign = \"center\";\r\n    multiPlayText.x = canvas.width / 2;\r\n    multiPlayText.y = 300;\r\n    multiPlayText.name = \"multi\";\r\n    creditText.textAlign = \"center\";\r\n    creditText.x = canvas.width / 2;\r\n    creditText.y = 330;\r\n    creditText.name = \"credit\";\r\n    scoreText.textAlign = \"center\";\r\n    scoreText.x = canvas.width - 50;\r\n    scoreText.y = canvas.height - 25;\r\n    hpText.textAlign = \"center\";\r\n    hpText.x = 40;\r\n    hpText.y = canvas.height - 25;\r\n    overText.textAlign = \"center\";\r\n    overText.x = canvas.width / 2;\r\n    overText.y = canvas.height / 3 + 60;\r\n    developerText.textAlign = \"center\";\r\n    developerText.x = canvas.width / 2;\r\n    developerText.y = canvas.height - 25;\r\n    playerText.textAlign = \"center\";\r\n    playerText.x = canvas.width / 2;\r\n    playerText.y = canvas.height - 70;\r\n}\r\n\r\n// Remove menu from stage\r\nfunction removeMenu() {\r\n    stage.removeChild(gameText, descriptionText, singlePlayText, multiPlayText, creditText, developerText);\r\n}\r\n\r\n// Add menu to stage\r\nfunction addMenu() {\r\n    stage.addChild(gameText, descriptionText, singlePlayText, multiPlayText, creditText, developerText);\r\n}\r\n\r\n// Load background image\r\nfunction loadBackground(e) {\r\n    bg = new createjs.Bitmap(bgSrc);\r\n    stage.addChild(bg);\r\n    stage.update();\r\n}\r\n\r\n// Display Game Over\r\nfunction gameOver() {\r\n    stage.removeChild(wordContainer);\r\n    stage.addChild(overText);\r\n}\r\n\r\nfunction capitaliseFirstLetter(string)\r\n{\r\n    return string.charAt(0).toUpperCase() + string.slice(1);\r\n}\r\n\r\nfunction isClick(text) {\r\n\tvar mouseTarget = stage.getObjectUnderPoint(stage.mouseX, stage.mouseY);\r\n    var targetName = String(mouseTarget.name);\r\n    return (targetName != null && targetName == text && click)\r\n}\r\n\r\n// Update canvas\r\nfunction tick() {\r\n    if (!isStart) {\r\n        addMenu();\r\n        if (isClick(\"single\")) {\r\n        \tstage.addChild(scoreText);\r\n            stage.addChild(hpText)\r\n            stage.addChild(playerText);\r\n        \tisStart = true\r\n        }\r\n    } else {\r\n        removeMenu(); // Remove menu\r\n        // If game over, display Game Over TextField\r\n        if (+hp <= 0) {\r\n            isOver = true;\r\n            gameOver();\r\n        } // If game is not over, create and move word\r\n        else if (!isOver) {\r\n            create_counter++;\r\n            // Create word every 5 seconds\r\n            if (create_counter >=  ONE_SECOND * 3 * Math.pow(2, score/1000)) {\r\n                create_counter = 0;\r\n                createWord();\r\n            }\r\n            moveWord(); // Move word\r\n            var matched = highlightWord();\r\n            if (!matched && playerText.text.length != 0) {\r\n            \tcombo = 0;\r\n            \tplayerText.text = \"\";\r\n            }\r\n\r\n            current_word = getCurrentWord();\r\n            if (current_word != -1 && current_word == getCurrentWord()) {\r\n                score += 10 * wordList[current_word].text.length * wordList[current_word].y/1000;\r\n                scoreText.text = \"Score : \" + Math.round(score);\r\n                hp += Math.round(Math.log(combo+1));\r\n                hpText.text = \"HP : \" + Math.round(hp);\r\n                wordContainer.removeChild(wordList[current_word]);\r\n                wordList.splice(current_word, 1);\r\n                playerText.text = \"\";\r\n                combo += 2 * (combo + 1);\r\n        \t}\r\n        }\r\n    }\r\n\r\n    // update stage\r\n    stage.update();\r\n}"]],"start1":0,"start2":0,"length1":0,"length2":7659}]],"length":7659}
